{"version":3,"file":"readXlsxFileContents.js","names":["readXlsx","convertToJsonLegacyBehavior","convertToJsonSpreadsheetBehavior","convertMapToSchema","readXlsxFileContents","entries","xml","_ref","schema","map","options","_objectWithoutProperties","_excluded","result","_objectSpread","properties","data"],"sources":["../../source/read/readXlsxFileContents.js"],"sourcesContent":["import readXlsx from './readXlsx.js'\r\n\r\nimport convertToJsonLegacyBehavior from './schema/convertToJson.legacy.js'\r\nimport convertToJsonSpreadsheetBehavior from './schema/convertToJson.spreadsheet.js'\r\n\r\nimport convertMapToSchema from './schema/convertMapToSchema.js'\r\n\r\nexport default function readXlsxFileContents(entries, xml, { schema, map, ...options}) {\r\n\tif (!schema && map) {\r\n\t\tschema = convertMapToSchema(map)\r\n\t}\r\n\t// `readXlsx()` adds `options.rowMap`, if not passed.\r\n\tconst result = readXlsx(entries, xml, { ...options, properties: schema || options.properties })\r\n\tif (schema) {\r\n\t\treturn convertToJsonSpreadsheetBehavior(convertToJsonLegacyBehavior, result.data, schema, {\r\n\t\t\t...options,\r\n\t\t\tproperties: result.properties\r\n\t\t})\r\n\t}\r\n\treturn result\r\n}"],"mappings":";;;;;;;;;AAAA,OAAOA,QAAQ,MAAM,eAAe;AAEpC,OAAOC,2BAA2B,MAAM,kCAAkC;AAC1E,OAAOC,gCAAgC,MAAM,uCAAuC;AAEpF,OAAOC,kBAAkB,MAAM,gCAAgC;AAE/D,eAAe,SAASC,oBAAoBA,CAACC,OAAO,EAAEC,GAAG,EAAAC,IAAA,EAA8B;EAAA,IAA1BC,MAAM,GAAAD,IAAA,CAANC,MAAM;IAAEC,GAAG,GAAAF,IAAA,CAAHE,GAAG;IAAKC,OAAO,GAAAC,wBAAA,CAAAJ,IAAA,EAAAK,SAAA;EACnF,IAAI,CAACJ,MAAM,IAAIC,GAAG,EAAE;IACnBD,MAAM,GAAGL,kBAAkB,CAACM,GAAG,CAAC;EACjC;EACA;EACA,IAAMI,MAAM,GAAGb,QAAQ,CAACK,OAAO,EAAEC,GAAG,EAAAQ,aAAA,CAAAA,aAAA,KAAOJ,OAAO;IAAEK,UAAU,EAAEP,MAAM,IAAIE,OAAO,CAACK;EAAU,EAAE,CAAC;EAC/F,IAAIP,MAAM,EAAE;IACX,OAAON,gCAAgC,CAACD,2BAA2B,EAAEY,MAAM,CAACG,IAAI,EAAER,MAAM,EAAAM,aAAA,CAAAA,aAAA,KACpFJ,OAAO;MACVK,UAAU,EAAEF,MAAM,CAACE;IAAU,EAC7B,CAAC;EACH;EACA,OAAOF,MAAM;AACd"}